<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>将下载的结构化的数据转换为列数据 | liubaojie's site</title>
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="/css/font-awesome/css/font-awesome.min.css" type="text/css" />
  <link rel="stylesheet" href="/css/default.css" type="text/css" />
  <link rel="stylesheet" href="/css/desktop.css" type="text/css" />
  <link rel="stylesheet" href="/css/mobile.css" type="text/css" />
  <link rel="shortcut icon" href="/css/favicon.ico" type="image/x-icon" />
  <link rel="icon" href="/css/favicon.ico" mce_href="/favicon.ico" type="image/x-icon">
  <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
  <script src="/js/jquery-1.11.0.min.js" type="text/javascript"></script>
  <script src="/js/jquery-migrate-1.2.1.js" type="text/javascript"></script>
  <script src="/js/jquery.transit.min.js" type="text/javascript"></script>
  <script src="/js/common.js" type="text/javascript"></script>

<body>
  <link rel="stylesheet" href="/js/prettify/prettify.css" />
<style type="text/css">
  html {
    background: #333333;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
  }
  @media screen and (max-width: 750px){
    body { background: rgba(255, 255, 255, 0.9); }
  }
</style>

<div id="content" class="post" style="margin-top: 20px;">
  <div id="avatar" class="avatar circle" data-in-right="false" style="width: 150px; height: 150px; position: fixed; top: 40px; z-index: 99; opacity: 0;">
    <div class="center" style="margin-top: 4px; height: 142px; width: 142px; border-radius: 71px; background-image: url('../images/user.png');"></div>
  </div>

  <div class="entry" style="position: relative;">
    <h1 class="entry-title"><a href="/data-structure-transform" title="将下载的结构化的数据转换为列数据">将下载的结构化的数据转换为列数据</a></h1>

    <p class="entry-date">2016-03-15 
        <span class="lastModified" style="display: none;" data-source="_posts/python&R/2016-03-15-data-structure-transform.md">最后更新时间: 
        </span>
    </p>


    <h1 id="section">数据形式转换</h1>

<p>前段时间要做一个课程作业，需要用到各省的生产总值，到国家统计局网站上下载的数据是这样的：</p>

<table>
  <thead>
    <tr>
      <th>—</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>北京市</td>
      <td>342424.45</td>
      <td>843058.34</td>
      <td>……</td>
    </tr>
    <tr>
      <td>上海市</td>
      <td>343534.56</td>
      <td>435024.75</td>
      <td>……</td>
    </tr>
    <tr>
      <td>……</td>
      <td>……</td>
      <td>……</td>
      <td>……</td>
    </tr>
  </tbody>
</table>

<p>但是我需要的数据是这样的：</p>

<table>
  <thead>
    <tr>
      <th>年份</th>
      <th>省份</th>
      <th>产值</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2007</td>
      <td>北京市</td>
      <td>233333.33</td>
    </tr>
    <tr>
      <td>2008</td>
      <td>上海市</td>
      <td>233333.33</td>
    </tr>
    <tr>
      <td>……</td>
      <td>……</td>
      <td>……</td>
    </tr>
  </tbody>
</table>

<hr />

<p>用python的<code class="highlighter-rouge">pandas</code>包处理非常简单：</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">chengtou</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'yuanshi.csv'</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'gbk'</span><span class="p">)</span>
<span class="n">f</span><span class="o">=</span><span class="n">chengtou</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'test.csv'</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'gbk'</span><span class="p">)</span>
</code></pre>
</div>



  </div>


  <div id="menuIndex" class="sidenav">
    <div class="myinfo"><center>
      <div id="avatarHolder" class="avatar circle" style="width: 0px; height: 0px; box-shadow: none; margin-bottom: 20px;"></div>
      <a href="/index.html" title="Homepage"><i class="icon-home icon-large"></i> Home</a>
      <a href="http://www.linkedin.com/in"><i class="icon-linkedin-sign icon-large"></i> Profile</a>
      <a href="https://github.com/"><i class="icon-github icon-large"></i> Code</a>
      <a href="mailto:liubaojie2016@163.com"><i class="icon-envelope icon-large"></i> Mail</a>
    </center></div>
    <div id="menu"></div>
  </div>
</div>

<script src="/js/post.js" type="text/javascript"></script>


<!-- 多说评论框 start -->


</body>


</html>
